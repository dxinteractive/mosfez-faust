import type { DspDefinition } from "../types";

const dsp = `
import("stdfaust.lib");


harp = waveform{
  0, 0.12479018419981003, 0.251503050327301, 0.34427931904792786, 0.4060182571411133, 0.443006694316864, 0.45460373163223267, 0.4426404535770416, 0.4195684790611267, 0.3874324858188629, 0.35166478157043457, 0.32825708389282227, 0.3188268542289734, 0.3190099895000458, 0.3197424113750458, 0.30481886863708496, 0.2686544358730316, 0.21985533833503723, 0.18124942481517792, 0.16830958425998688, 0.16934721171855927, 0.1598864644765854, 0.13193151354789734, 0.0871303454041481, 0.032868433743715286, -0.0274658203125, -0.099945068359375, -0.1845703125, -0.27093505859375, -0.3499755859375, -0.414093017578125, -0.46533203125, -0.50830078125, -0.536834716796875, -0.546142578125, -0.550689697265625, -0.558074951171875, -0.56298828125, -0.548614501953125, -0.51556396484375, -0.481353759765625, -0.45733642578125, -0.431793212890625, -0.374603271484375, -0.27001953125, -0.1376953125, -0.005340576171875, 0.11243018507957458, 0.20529800653457642, 0.269875168800354, 0.3094882071018219, 0.3243812322616577, 0.31464582681655884, 0.2931302785873413, 0.27283546328544617, 0.2625507414340973, 0.2688680589199066, 0.29065829515457153, 0.3192846477031708, 0.3328653872013092, 0.3195287883281708, 0.29059725999832153, 0.26618245244026184, 0.2601702809333801, 0.2709738314151764, 0.2856532335281372, 0.2923673093318939, 0.2862636148929596, 0.2614215612411499, 0.21811579167842865, 0.15668202936649323, 0.07736442238092422, -0.00714111328125, -0.085845947265625, -0.154388427734375, -0.21478271484375, -0.26654052734375, -0.306243896484375, -0.33563232421875, -0.36474609375, -0.39837646484375, -0.42327880859375, -0.426177978515625, -0.40997314453125, -0.397125244140625, -0.400421142578125, -0.40142822265625, -0.376800537109375, -0.31744384765625, -0.219512939453125,
  -0.18701171875, -0.09, 0, 0.13763847947120667, 0.22666096687316895, 0.28949856758117676, 0.3239845037460327, 0.3324381113052368, 0.3264259696006775, 0.31241798400878906, 0.29578539729118347, 0.2920621335506439, 0.3097628653049469, 0.33744317293167114, 0.3559068441390991, 0.3508712947368622, 0.32786035537719727, 0.3019196093082428, 0.2842188775539398, 0.2775658369064331, 0.27988526225090027, 0.28250983357429504, 0.28244879841804504, 0.27298808097839355, 0.24185918271541595, 0.18048647046089172, 0.09732352942228317, 0.004821924492716789, -0.0880126953125, -0.179473876953125, -0.269287109375, -0.346160888671875, -0.404541015625, -0.447052001953125, -0.483001708984375, -0.518798828125, -0.5396728515625, -0.535980224609375, -0.523284912109375, -0.51226806640625, -0.506500244140625, -0.49755859375, -0.47125244140625, -0.4189453125, -0.3387451171875, -0.234710693359375, -0.1148681640625, 0.011352885514497757, 0.13006988167762756, 0.22650837898254395, 0.29572436213493347, 0.3396404981613159, 0.3562120497226715, 0.3500778079032898, 0.33664968609809875, 0.33017975091934204, 0.3397625684738159, 0.35343486070632935, 0.3564561903476715, 0.34415721893310547, 0.3186742663383484, 0.287087619304657, 0.25727102160453796, 0.23151341080665588, 0.21170690655708313, 0.20303964614868164, 0.2061525285243988, 0.20764793455600739, 0.1893978714942932, 0.14178898930549622, 0.07324442267417908, -0.006317138671875, -0.092254638671875, -0.1827392578125, -0.27459716796875, -0.35467529296875, -0.415618896484375, -0.465545654296875, -0.512847900390625, -0.5531005859375, -0.57427978515625, -0.57257080078125, -0.556304931640625, -0.54132080078125, -0.53167724609375, -0.52099609375, -0.49993896484375, -0.455291748046875, -0.38763427734375, -0.299102783203125, -0.2, -0.09
};

harp1 = waveform{
  0, 0.12479018419981003, 0.251503050327301, 0.34427931904792786, 0.4060182571411133, 0.443006694316864, 0.45460373163223267, 0.4426404535770416, 0.4195684790611267, 0.3874324858188629, 0.35166478157043457, 0.32825708389282227, 0.3188268542289734, 0.3190099895000458, 0.3197424113750458, 0.30481886863708496, 0.2686544358730316, 0.21985533833503723, 0.18124942481517792, 0.16830958425998688, 0.16934721171855927, 0.1598864644765854, 0.13193151354789734, 0.0871303454041481, 0.032868433743715286, -0.0274658203125, -0.099945068359375, -0.1845703125, -0.27093505859375, -0.3499755859375, -0.414093017578125, -0.46533203125, -0.50830078125, -0.536834716796875, -0.546142578125, -0.550689697265625, -0.558074951171875, -0.56298828125, -0.548614501953125, -0.51556396484375, -0.481353759765625, -0.45733642578125, -0.431793212890625, -0.374603271484375, -0.27001953125, -0.1376953125, -0.005340576171875, 0.11243018507957458, 0.20529800653457642, 0.269875168800354, 0.3094882071018219, 0.3243812322616577, 0.31464582681655884, 0.2931302785873413, 0.27283546328544617, 0.2625507414340973, 0.2688680589199066, 0.29065829515457153, 0.3192846477031708, 0.3328653872013092, 0.3195287883281708, 0.29059725999832153, 0.26618245244026184, 0.2601702809333801, 0.2709738314151764, 0.2856532335281372, 0.2923673093318939, 0.2862636148929596, 0.2614215612411499, 0.21811579167842865, 0.15668202936649323, 0.07736442238092422, -0.00714111328125, -0.085845947265625, -0.154388427734375, -0.21478271484375, -0.26654052734375, -0.306243896484375, -0.33563232421875, -0.36474609375, -0.39837646484375, -0.42327880859375, -0.426177978515625, -0.40997314453125, -0.397125244140625, -0.400421142578125, -0.40142822265625, -0.376800537109375, -0.31744384765625, -0.219512939453125
};

harp2 = waveform{
  0.27988526225090027, 0.28250983357429504, 0.28244879841804504, 0.27298808097839355, 0.24185918271541595, 0.18048647046089172, 0.09732352942228317, 0.004821924492716789, -0.0880126953125, -0.179473876953125, -0.269287109375, -0.346160888671875, -0.404541015625, -0.447052001953125, -0.483001708984375, -0.518798828125, -0.5396728515625, -0.535980224609375, -0.523284912109375, -0.51226806640625, -0.506500244140625, -0.49755859375, -0.47125244140625, -0.4189453125, -0.3387451171875, -0.234710693359375, -0.1148681640625, 0.011352885514497757, 0.13006988167762756, 0.22650837898254395, 0.29572436213493347, 0.3396404981613159, 0.3562120497226715, 0.3500778079032898, 0.33664968609809875, 0.33017975091934204, 0.3397625684738159, 0.35343486070632935, 0.3564561903476715, 0.34415721893310547, 0.3186742663383484, 0.287087619304657, 0.25727102160453796, 0.23151341080665588, 0.21170690655708313, 0.20303964614868164, 0.2061525285243988, 0.20764793455600739, 0.1893978714942932, 0.14178898930549622, 0.07324442267417908, -0.006317138671875, -0.092254638671875, -0.1827392578125, -0.27459716796875, -0.35467529296875, -0.415618896484375, -0.465545654296875, -0.512847900390625, -0.5531005859375, -0.57427978515625, -0.57257080078125, -0.556304931640625, -0.54132080078125, -0.53167724609375, -0.52099609375, -0.49993896484375, -0.455291748046875, -0.38763427734375, -0.299102783203125, -0.18701171875, -0.09, 0, 0.13763847947120667, 0.22666096687316895, 0.28949856758117676, 0.3239845037460327, 0.3324381113052368, 0.3264259696006775, 0.31241798400878906, 0.29578539729118347, 0.2920621335506439, 0.3097628653049469, 0.33744317293167114, 0.3559068441390991, 0.3508712947368622, 0.32786035537719727, 0.3019196093082428, 0.2842188775539398, 0.2775658369064331
};

snapshot_pulse_samples = 100;
lookbehind_samples = 100;

sample_points = waveform{8,8,8,8,8,8,8,8};
sample_points_scan = sample_points,ba.time % 9 : rdtable;
sample_point = input : de.delay(lookbehind_samples, 100);

input = harp,ba.time % 182 : rdtable;
snapshot_pulse = ba.time % snapshot_pulse_samples == 0;



process = input,snapshot_pulse,sample_point;
`;

const dspDefinition: DspDefinition = {
  id: "autocorrelation",
  name: "Autocorrelation",
  description: "Trying to make a Faust autocorrelation thing",
  dsp,
  type: "offline",
  outputLength: 300,
  sampleRate: 44100,
  channels: 4,
};

export default dspDefinition;
